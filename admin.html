<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>FoxPro åå°ç®¡ç†ç³»ç»Ÿ</title>
  <style>
    :root {
      --primary: #3b82f6;
      --danger: #ef4444;
      --success: #10b981;
      --warning: #f59e0b;
      --bg: #0f172a;
      --bg-secondary: #1e293b;
      --text: #f1f5f9;
      --text-muted: #94a3b8;
      --border: #475569;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: var(--bg);
      color: var(--text);
    }

    .admin-container {
      display: flex;
      min-height: 100vh;
    }

    /* Sidebar */
    .sidebar {
      width: 280px;
      background: var(--bg-secondary);
      border-right: 1px solid var(--border);
      padding: 20px 0;
      overflow-y: auto;
      max-height: 100vh;
    }

    .sidebar-header {
      padding: 0 20px 20px;
      border-bottom: 1px solid var(--border);
      margin-bottom: 20px;
    }

    .sidebar-title {
      font-size: 18px;
      font-weight: 700;
      color: var(--primary);
    }

    .nav-section {
      padding: 0;
      margin-bottom: 10px;
    }

    .nav-section-title {
      padding: 10px 20px;
      font-size: 12px;
      font-weight: 600;
      color: var(--text-muted);
      text-transform: uppercase;
    }

    .nav-link {
      padding: 12px 20px;
      background: none;
      border: none;
      color: var(--text-muted);
      cursor: pointer;
      text-align: left;
      font-size: 14px;
      transition: all 0.2s;
      display: block;
      width: 100%;
    }

    .nav-link:hover {
      background: rgba(59, 130, 246, 0.1);
      color: var(--text);
    }

    .nav-link.active {
      background: rgba(59, 130, 246, 0.2);
      color: var(--primary);
      border-left: 3px solid var(--primary);
      padding-left: 17px;
    }

    /* Main Content */
    .main-content {
      flex: 1;
      display: flex;
      flex-direction: column;
    }

    .header {
      background: var(--bg-secondary);
      border-bottom: 1px solid var(--border);
      padding: 20px 40px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .header-title {
      font-size: 24px;
      font-weight: 700;
    }

    .logout-btn {
      padding: 10px 20px;
      background: var(--danger);
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-weight: 600;
      transition: all 0.2s;
    }

    .logout-btn:hover {
      opacity: 0.9;
    }

    .content {
      flex: 1;
      padding: 40px;
      overflow-y: auto;
    }

    .section {
      display: none;
    }

    .section.active {
      display: block;
    }

    .section-title {
      font-size: 28px;
      font-weight: 700;
      margin-bottom: 30px;
      color: var(--text);
    }

    /* Cards and Forms */
    .card {
      background: var(--bg-secondary);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 24px;
      margin-bottom: 20px;
    }

    .card-title {
      font-size: 18px;
      font-weight: 600;
      margin-bottom: 20px;
      color: var(--text);
    }

    .form-group {
      margin-bottom: 20px;
    }

    .form-group label {
      display: block;
      margin-bottom: 8px;
      color: var(--text-muted);
      font-size: 13px;
      font-weight: 600;
    }

    .form-group input,
    .form-group textarea,
    .form-group select {
      width: 100%;
      padding: 10px 12px;
      background: var(--bg);
      border: 1px solid var(--border);
      border-radius: 6px;
      color: var(--text);
      font-size: 13px;
      font-family: inherit;
    }

    .form-group textarea {
      resize: vertical;
      min-height: 100px;
    }

    .form-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
    }

    /* Tables */
    .table-container {
      background: var(--bg-secondary);
      border: 1px solid var(--border);
      border-radius: 12px;
      overflow: hidden;
      margin-bottom: 20px;
    }

    .table-header {
      padding: 20px;
      border-bottom: 1px solid var(--border);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .table-header-title {
      font-size: 16px;
      font-weight: 600;
    }

    .btn {
      padding: 10px 16px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-weight: 600;
      transition: all 0.2s;
      font-size: 13px;
    }

    .btn-primary {
      background: var(--primary);
      color: white;
    }

    .btn-primary:hover {
      opacity: 0.9;
    }

    .btn-danger {
      background: var(--danger);
      color: white;
    }

    .btn-success {
      background: var(--success);
      color: white;
    }

    .btn-warning {
      background: var(--warning);
      color: white;
    }

    .btn-small {
      padding: 6px 12px;
      font-size: 12px;
    }
    
    .tab-btn {
      padding: 10px 20px;
      border: 1px solid #ddd;
      background: #f5f5f5;
      border-radius: 4px 4px 0 0;
      cursor: pointer;
      transition: all 0.3s ease;
      font-weight: 600;
    }
    
    .tab-btn.active {
      background: #3b82f6;
      color: white;
      border-color: #3b82f6;
    }
    
    .tab-btn:hover {
      border-color: #3b82f6;
    }
    
    .form-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 15px;
      margin-bottom: 15px;
    }
    
    .form-group {
      display: flex;
      flex-direction: column;
    }
    
    .form-group label {
      margin-bottom: 8px;
      font-weight: 600;
      color: #555;
    }
    
    .form-group input {
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 4px;
      font-size: 14px;
    }
    
    .form-group input:focus {
      outline: none;
      border-color: #3b82f6;
      box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
    }
    
    .badge-success {
      background: #d1fae5;
      color: #065f46;
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 12px;
    }
    
    .badge-danger {
      background: #fee2e2;
      color: #991b1b;
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 12px;
    }
    
    .badge-warning {
      background: #fef3c7;
      color: #b45309;
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 12px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
    }

    th {
      background: rgba(59, 130, 246, 0.1);
      padding: 12px 20px;
      text-align: left;
      font-weight: 600;
      border-bottom: 1px solid var(--border);
    }

    td {
      padding: 12px 20px;
      border-bottom: 1px solid var(--border);
      color: var(--text-muted);
    }

    tr:hover {
      background: rgba(59, 130, 246, 0.05);
    }

    .badge {
      display: inline-block;
      padding: 4px 12px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: 600;
    }

    .badge-success {
      background: rgba(16, 185, 129, 0.2);
      color: var(--success);
    }

    .badge-warning {
      background: rgba(245, 158, 11, 0.2);
      color: var(--warning);
    }

    .badge-danger {
      background: rgba(239, 68, 68, 0.2);
      color: var(--danger);
    }

    .stat-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }

    .stat-card {
      background: var(--bg-secondary);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 20px;
    }

    .stat-label {
      color: var(--text-muted);
      font-size: 13px;
      margin-bottom: 8px;
    }

    .stat-value {
      font-size: 28px;
      font-weight: 700;
      color: var(--primary);
    }

    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.7);
      z-index: 1000;
      align-items: center;
      justify-content: center;
    }

    .modal.active {
      display: flex;
    }

    .modal-content {
      background: var(--bg-secondary);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 40px;
      max-width: 500px;
      width: 90%;
      max-height: 80vh;
      overflow-y: auto;
    }

    .modal-header {
      font-size: 20px;
      font-weight: 700;
      margin-bottom: 20px;
    }

    .modal-close {
      position: absolute;
      top: 20px;
      right: 20px;
      background: none;
      border: none;
      color: var(--text-muted);
      cursor: pointer;
      font-size: 24px;
    }

    .alert {
      padding: 12px 16px;
      border-radius: 6px;
      margin-bottom: 20px;
      font-size: 13px;
    }

    .alert-success {
      background: rgba(16, 185, 129, 0.1);
      color: var(--success);
      border: 1px solid var(--success);
    }

    .alert-danger {
      background: rgba(239, 68, 68, 0.1);
      color: var(--danger);
      border: 1px solid var(--danger);
    }

    .alert-warning {
      background: rgba(245, 158, 11, 0.1);
      color: var(--warning);
      border: 1px solid var(--warning);
    }

    .refresh-btn {
      padding: 8px 16px;
      background: var(--primary);
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 13px;
      font-weight: 600;
    }

    .empty-state {
      text-align: center;
      padding: 40px 20px;
      color: var(--text-muted);
    }
  </style>
</head>
<body>
  <div class="admin-container">
    <!-- Sidebar -->
    <div class="sidebar">
      <div class="sidebar-header">
        <div class="sidebar-title">FoxPro åå°</div>
      </div>

      <!-- æ ¸å¿ƒç®¡ç† -->
      <div class="nav-section">
        <div class="nav-section-title">æ ¸å¿ƒç®¡ç†</div>
        <button class="nav-link active" data-section="dashboard" onclick="switchSection('dashboard')">ğŸ“Š ä»ªè¡¨ç›˜</button>
        <button class="nav-link" data-section="users" onclick="switchSection('users')">ğŸ‘¥ ç”¨æˆ·ç®¡ç†</button>
      </div>

      <!-- èº«ä»½è®¤è¯ -->
      <div class="nav-section">
        <div class="nav-section-title">èº«ä»½è®¤è¯</div>
        <button class="nav-link" data-section="primary-auth" onclick="switchSection('primary-auth')">ğŸ“‹ åˆçº§è®¤è¯</button>
        <button class="nav-link" data-section="advanced-auth" onclick="switchSection('advanced-auth')">ğŸ” é«˜çº§è®¤è¯</button>
      </div>

      <!-- äº¤æ˜“ç®¡ç† -->
      <div class="nav-section">
        <div class="nav-section-title">äº¤æ˜“ç®¡ç†</div>
        <button class="nav-link" data-section="quick-contract" onclick="switchSection('quick-contract')">âš¡ ç§’åˆçº¦é…ç½®</button>
        <button class="nav-link" data-section="contract-trades" onclick="switchSection('contract-trades')">ğŸ“ˆ ç§’åˆçº¦äº¤æ˜“</button>
        <button class="nav-link" data-section="wealth" onclick="switchSection('wealth')">ğŸ’° ç†è´¢äº§å“</button>
        <button class="nav-link" data-section="exchange-rates" onclick="switchSection('exchange-rates')">ğŸ’± å…‘æ¢å¸ç§</button>
      </div>

      <!-- èµ„äº§ç®¡ç† -->
      <div class="nav-section">
        <div class="nav-section-title">èµ„äº§ç®¡ç†</div>
        <button class="nav-link" data-section="balance" onclick="switchSection('balance')">ğŸ’µ ç”¨æˆ·ä½™é¢</button>
        <button class="nav-link" data-section="recharge" onclick="switchSection('recharge')">â¬†ï¸ å……å€¼ç®¡ç†</button>
        <button class="nav-link" data-section="withdraw" onclick="switchSection('withdraw')">â¬‡ï¸ æç°ç®¡ç†</button>
        <button class="nav-link" data-section="lending" onclick="switchSection('lending')">ğŸ¦ å€Ÿè´·ç®¡ç†</button>
      </div>

      <!-- ç³»ç»Ÿç®¡ç† -->
      <div class="nav-section">
        <div class="nav-section-title">ç³»ç»Ÿç®¡ç†</div>
        <button class="nav-link" data-section="pages" onclick="switchSection('pages')">ğŸ“„ é¡µé¢ç®¡ç†</button>
        <button class="nav-link" data-section="system" onclick="switchSection('system')">âš™ï¸ ç³»ç»Ÿè®¾ç½®</button>
      </div>
    </div>

    <!-- Main Content -->
    <div class="main-content">
      <!-- Header -->
      <div class="header">
        <div class="header-title" id="headerTitle">ä»ªè¡¨ç›˜</div>
        <div>
          <span style="margin-right: 20px; color: var(--text-muted);" id="adminName">ç®¡ç†å‘˜</span>
          <button class="logout-btn" onclick="logout()">ç™»å‡º</button>
        </div>
      </div>

      <!-- Content -->
      <div class="content">
        <!-- ä»ªè¡¨ç›˜ -->
        <div id="dashboard" class="section active">
          <h1 class="section-title">ä»ªè¡¨ç›˜</h1>
          <div class="stat-grid">
            <div class="stat-card">
              <div class="stat-label">æ€»ç”¨æˆ·æ•°</div>
              <div class="stat-value" id="statUsers">0</div>
            </div>
            <div class="stat-card">
              <div class="stat-label">æ´»è·ƒäº¤æ˜“</div>
              <div class="stat-value" id="statTrades">0</div>
            </div>
            <div class="stat-card">
              <div class="stat-label">å¾…å®¡æ ¸</div>
              <div class="stat-value" id="statPending">0</div>
            </div>
            <div class="stat-card">
              <div class="stat-label">æ€»èµ„äº§</div>
              <div class="stat-value" id="statAssets">$0</div>
            </div>
          </div>
          <button class="refresh-btn" onclick="loadDashboard()">ğŸ”„ åˆ·æ–°æ•°æ®</button>
        </div>

        <!-- ç”¨æˆ·ç®¡ç† -->
        <div id="users" class="section">
          <h1 class="section-title">ç”¨æˆ·ç®¡ç†</h1>
          <div class="table-container">
            <div class="table-header">
              <div class="table-header-title">ç”¨æˆ·åˆ—è¡¨</div>
              <button class="refresh-btn" onclick="loadUsers()">ğŸ”„ åˆ·æ–°</button>
            </div>
            <table>
              <thead>
                <tr>
                  <th>ç”¨æˆ·å</th>
                  <th>é‚®ç®±</th>
                  <th>ç”µè¯</th>
                  <th>çŠ¶æ€</th>
                  <th>æ“ä½œ</th>
                </tr>
              </thead>
              <tbody id="usersTable">
                <tr><td colspan="5" class="empty-state">åŠ è½½ä¸­...</td></tr>
              </tbody>
            </table>
          </div>
        </div>

        <!-- åˆçº§è®¤è¯ -->
        <div id="primary-auth" class="section">
          <h1 class="section-title">åˆçº§è®¤è¯å®¡æ ¸</h1>
          <div class="table-container">
            <div class="table-header">
              <div class="table-header-title">å¾…å®¡æ ¸è®¤è¯</div>
              <button class="refresh-btn" onclick="loadPrimaryAuth()">ğŸ”„ åˆ·æ–°</button>
            </div>
            <table>
              <thead>
                <tr>
                  <th>ç”¨æˆ·</th>
                  <th>èº«ä»½è¯å·</th>
                  <th>æäº¤æ—¶é—´</th>
                  <th>çŠ¶æ€</th>
                  <th>æ“ä½œ</th>
                </tr>
              </thead>
              <tbody id="primaryAuthTable">
                <tr><td colspan="5" class="empty-state">åŠ è½½ä¸­...</td></tr>
              </tbody>
            </table>
          </div>
        </div>

        <!-- é«˜çº§è®¤è¯ -->
        <div id="advanced-auth" class="section">
          <h1 class="section-title">é«˜çº§è®¤è¯å®¡æ ¸</h1>
          <div class="table-container">
            <div class="table-header">
              <div class="table-header-title">å¾…å®¡æ ¸è®¤è¯</div>
              <button class="refresh-btn" onclick="loadAdvancedAuth()">ğŸ”„ åˆ·æ–°</button>
            </div>
            <table>
              <thead>
                <tr>
                  <th>ç”¨æˆ·</th>
                  <th>é“¶è¡Œå¡å·</th>
                  <th>æäº¤æ—¶é—´</th>
                  <th>çŠ¶æ€</th>
                  <th>æ“ä½œ</th>
                </tr>
              </thead>
              <tbody id="advancedAuthTable">
                <tr><td colspan="5" class="empty-state">åŠ è½½ä¸­...</td></tr>
              </tbody>
            </table>
          </div>
        </div>

        <!-- ç§’åˆçº¦é…ç½® -->
        <div id="quick-contract" class="section">
          <h1 class="section-title">ç§’åˆçº¦é…ç½®</h1>
          <div class="card">
            <div class="card-title">æ·»åŠ æ–°çš„ç§’åˆçº¦å‘¨æœŸ</div>
            <div class="form-grid">
              <div class="form-group">
                <label>åˆçº¦å‘¨æœŸï¼ˆç§’ï¼‰</label>
                <input type="number" id="newSeconds" value="60" min="10" max="3600">
              </div>
              <div class="form-group">
                <label>ç›ˆåˆ©æ¯”ä¾‹ (%)</label>
                <input type="number" id="newProfitRate" value="50" min="10" max="200" step="5">
              </div>
            </div>
            <button class="btn btn-primary" onclick="addNewQuickContractPeriod()">â• æ·»åŠ å‘¨æœŸ</button>
          </div>

          <div class="table-container">
            <div class="table-header">
              <div class="table-header-title">ç§’åˆçº¦å‘¨æœŸé…ç½®</div>
            </div>
            <table>
              <thead>
                <tr>
                  <th>å‘¨æœŸï¼ˆç§’ï¼‰</th>
                  <th>ç›ˆåˆ©æ¯”ä¾‹ (%)</th>
                  <th>æ“ä½œ</th>
                </tr>
              </thead>
              <tbody id="contractConfigTable">
                <tr><td colspan="5" class="empty-state">åŠ è½½ä¸­...</td></tr>
              </tbody>
            </table>
          </div>
        </div>

        <!-- ç§’åˆçº¦äº¤æ˜“ -->
        <div id="contract-trades" class="section">
          <h1 class="section-title">ç§’åˆçº¦äº¤æ˜“ç®¡ç†</h1>
          
          <div class="table-container">
            <div class="table-header">
              <div class="table-header-title">æ‰€æœ‰ç§’åˆçº¦äº¤æ˜“è®°å½•</div>
              <button class="refresh-btn" onclick="loadContractTrades()">ğŸ”„ åˆ·æ–°</button>
            </div>
            <table>
              <thead>
                <tr>
                  <th>ç”¨æˆ·</th>
                  <th>å¸ç§</th>
                  <th>æ–¹å‘</th>
                  <th>é‡‘é¢</th>
                  <th>å‘¨æœŸ</th>
                  <th>å…¥åœºä»·</th>
                  <th>å‡ºåœºä»·</th>
                  <th>æ”¶ç›Š</th>
                  <th>çŠ¶æ€</th>
                  <th>æ“ä½œ</th>
                </tr>
              </thead>
              <tbody id="tradesTable">
                <tr><td colspan="10" class="empty-state">åŠ è½½ä¸­...</td></tr>
              </tbody>
            </table>
          </div>
        </div>

                </select>
              </div>
              <button class="btn btn-success" onclick="setTradeResult()">è®¾ç½®ç»“æœ</button>
            </div>
          </div>

          <div class="table-container">
            <div class="table-header">
              <div class="table-header-title">è¿›è¡Œä¸­çš„äº¤æ˜“</div>
              <button class="refresh-btn" onclick="loadContractTrades()">ğŸ”„ åˆ·æ–°</button>
            </div>
            <table>
              <thead>
                <tr>
                  <th>ç”¨æˆ·</th>
                  <th>é‡‘é¢</th>
                  <th>æ–¹å‘</th>
                  <th>æ—¶é—´</th>
                  <th>çŠ¶æ€</th>
                  <th>æ“ä½œ</th>
                </tr>
              </thead>
              <tbody id="tradesTable">
                <tr><td colspan="6" class="empty-state">åŠ è½½ä¸­...</td></tr>
              </tbody>
            </table>
          </div>
        </div>

        <!-- ç†è´¢äº§å“ -->
        <div id="wealth" class="section">
          <h1 class="section-title">ç†è´¢äº§å“ç®¡ç†</h1>
          <div class="card">
            <div class="card-title">æ–°å¢ç†è´¢äº§å“</div>
            <div class="form-grid">
              <div class="form-group">
                <label>äº§å“åç§°</label>
                <input type="text" id="wealthName" placeholder="ä¾‹ï¼š30å¤©ç†è´¢è®¡åˆ’">
              </div>
              <div class="form-group">
                <label>å‘¨æœŸï¼ˆå¤©ï¼‰</label>
                <input type="number" id="wealthPeriod" placeholder="30" min="1">
              </div>
              <div class="form-group">
                <label>å¹´åŒ–æ”¶ç›Šç‡ (%)</label>
                <input type="number" id="wealthRate" placeholder="12.5" min="0.1" step="0.1">
              </div>
              <div class="form-group">
                <label>æœ€ä½æŠ•èµ„</label>
                <input type="number" id="wealthMin" placeholder="100" min="1">
              </div>
            </div>
            <button class="btn btn-primary" onclick="addWealthProduct()">â• æ·»åŠ äº§å“</button>
          </div>

          <div class="table-container">
            <div class="table-header">
              <div class="table-header-title">ç†è´¢äº§å“åˆ—è¡¨</div>
              <button class="refresh-btn" onclick="loadWealthProducts()">ğŸ”„ åˆ·æ–°</button>
            </div>
            <table>
              <thead>
                <tr>
                  <th>äº§å“åç§°</th>
                  <th>å‘¨æœŸ</th>
                  <th>å¹´åŒ–æ”¶ç›Š</th>
                  <th>æœ€ä½æŠ•èµ„</th>
                  <th>å·²è´­äººæ•°</th>
                  <th>æ“ä½œ</th>
                </tr>
              </thead>
              <tbody id="wealthTable">
                <tr><td colspan="6" class="empty-state">åŠ è½½ä¸­...</td></tr>
              </tbody>
            </table>
          </div>
        </div>

        <!-- å…‘æ¢å¸ç§ -->
        <div id="exchange-rates" class="section">
          <h1 class="section-title">å¸ç§å…‘æ¢ç®¡ç†</h1>
          <div class="card">
            <div class="card-title">å…‘æ¢æ–¹å¼é€‰æ‹©</div>
            <div style="display: flex; gap: 10px; margin-bottom: 20px;">
              <button class="tab-btn active" onclick="switchExchangeTab('all')">ğŸ“Š æ‰€æœ‰å…‘æ¢è®°å½•</button>
              <button class="tab-btn" onclick="switchExchangeTab('user')">ğŸ‘¤ ç‰¹å®šç”¨æˆ·æŸ¥è¯¢</button>
            </div>
          </div>

          <!-- æ‰€æœ‰å…‘æ¢è®°å½• -->
          <div id="exchangeAllTab" class="table-container">
            <div class="table-header">
              <div class="table-header-title">æ‰€æœ‰ç”¨æˆ·å…‘æ¢è®°å½•</div>
              <button class="refresh-btn" onclick="loadAllExchangeRecords()">ğŸ”„ åˆ·æ–°</button>
            </div>
            <table>
              <thead>
                <tr>
                  <th>ç”¨æˆ·</th>
                  <th>å…‘å‡ºå¸ç§</th>
                  <th>å…‘å‡ºæ•°é‡</th>
                  <th>å…‘å…¥å¸ç§</th>
                  <th>å…‘å…¥æ•°é‡</th>
                  <th>æ±‡ç‡</th>
                  <th>æ‰‹ç»­è´¹</th>
                  <th>æ—¶é—´</th>
                  <th>çŠ¶æ€</th>
                </tr>
              </thead>
              <tbody id="exchangeAllTable">
                <tr><td colspan="9" class="empty-state">åŠ è½½ä¸­...</td></tr>
              </tbody>
            </table>
          </div>

          <!-- ç‰¹å®šç”¨æˆ·æŸ¥è¯¢ -->
          <div id="exchangeUserTab" style="display: none;">
            <div class="card">
              <div class="card-title">æŒ‰ç”¨æˆ·æŸ¥è¯¢å…‘æ¢è®°å½•</div>
              <div class="form-grid">
                <div class="form-group">
                  <label>é€‰æ‹©ç”¨æˆ·</label>
                  <select id="exchangeUserSelect" onchange="loadExchangeUserRecords()">
                    <option value="">åŠ è½½ç”¨æˆ·ä¸­...</option>
                  </select>
                </div>
              </div>
            </div>
            <div class="table-container" style="margin-top: 20px;">
              <div class="table-header">
                <div class="table-header-title" id="exchangeUserTitle">ç”¨æˆ·å…‘æ¢è®°å½•</div>
                <button class="refresh-btn" onclick="loadExchangeUserRecords()">ğŸ”„ åˆ·æ–°</button>
              </div>
              <table>
                <thead>
                  <tr>
                    <th>å…‘å‡ºå¸ç§</th>
                    <th>å…‘å‡ºæ•°é‡</th>
                    <th>å…‘å…¥å¸ç§</th>
                    <th>å…‘å…¥æ•°é‡</th>
                    <th>æ±‡ç‡</th>
                    <th>æ‰‹ç»­è´¹</th>
                    <th>æ—¶é—´</th>
                    <th>çŠ¶æ€</th>
                  </tr>
                </thead>
                <tbody id="exchangeUserTable">
                  <tr><td colspan="8" class="empty-state">é€‰æ‹©ç”¨æˆ·æŸ¥çœ‹è®°å½•</td></tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>

        <!-- ç”¨æˆ·ä½™é¢ -->
        <div id="balance" class="section">
          <h1 class="section-title">ç”¨æˆ·ä½™é¢ç®¡ç†</h1>
          <div class="card">
            <div class="card-title">ä¿®æ”¹ç”¨æˆ·ä½™é¢</div>
            <div class="form-grid">
              <div class="form-group">
                <label>é€‰æ‹©ç”¨æˆ·</label>
                <select id="balanceUser">
                  <option value="">-- é€‰æ‹©ç”¨æˆ· --</option>
                </select>
              </div>
              <div class="form-group">
                <label>å½“å‰ä½™é¢</label>
                <input type="text" id="currentBalance" readonly>
              </div>
              <div class="form-group">
                <label>å˜åŠ¨é‡‘é¢</label>
                <input type="number" id="balanceAmount" placeholder="è¾“å…¥é‡‘é¢ï¼ˆå¯ä¸ºè´Ÿæ•°ï¼‰">
              </div>
              <div class="form-group">
                <label>æ“ä½œç±»å‹</label>
                <select id="balanceType">
                  <option value="add">â• å¢åŠ </option>
                  <option value="deduct">â– æ‰£å‡</option>
                </select>
              </div>
            </div>
            <button class="btn btn-primary" onclick="updateUserBalance()">ğŸ’¾ æ›´æ–°ä½™é¢</button>
          </div>
        </div>

        <!-- å……å€¼ç®¡ç† -->
        <div id="recharge" class="section">
          <h1 class="section-title">å……å€¼ç®¡ç†</h1>
          
          <!-- æ ‡ç­¾é¡µåˆ‡æ¢ -->
          <div style="margin-bottom: 20px; display: flex; gap: 10px;">
            <button class="tab-btn active" onclick="switchRechargeTab('config')">âš™ï¸ å¸ç§é…ç½®</button>
            <button class="tab-btn" onclick="switchRechargeTab('orders')">ğŸ“‹ å……å€¼è®¢å•</button>
          </div>

          <!-- å¸ç§é…ç½® -->
          <div id="rechargeConfigTab">
            <div class="card">
              <div class="card-title">â• æ·»åŠ æˆ–ç¼–è¾‘å……å€¼å¸ç§é…ç½®</div>
              <div class="form-grid">
                <div class="form-group">
                  <label>å¸ç§åç§° *</label>
                  <input type="text" id="rechargeCoin" placeholder="ä¾‹ï¼šBTC, ETH, USDT">
                </div>
                <div class="form-group">
                  <label>å……å€¼ç½‘ç»œ *</label>
                  <input type="text" id="rechargeNetwork" placeholder="ä¾‹ï¼šmainnet, TRC20, ERC20">
                </div>
                <div class="form-group">
                  <label>æœ€å°å……å€¼é‡‘é¢ *</label>
                  <input type="number" id="rechargeMinAmount" placeholder="ä¾‹ï¼š0.001" step="0.00000001" min="0">
                </div>
              </div>
              <div class="form-grid">
                <div class="form-group">
                  <label>é’±åŒ…åœ°å€ *</label>
                  <input type="text" id="rechargeAddress" placeholder="è¾“å…¥æ¥æ”¶å……å€¼çš„é’±åŒ…åœ°å€">
                </div>
                <div class="form-group">
                  <label>äºŒç»´ç URL (å¯é€‰)</label>
                  <input type="text" id="rechargeQRCode" placeholder="è¾“å…¥äºŒç»´ç å›¾ç‰‡URL">
                </div>
                <div class="form-group">
                  <label style="margin-top: 20px;">å¯ç”¨çŠ¶æ€</label>
                  <input type="checkbox" id="rechargeEnabled" checked style="width: auto; cursor: pointer; margin-top: 10px;"> å¯ç”¨æ­¤å¸ç§
                </div>
              </div>
              <div style="display: flex; gap: 10px;">
                <button class="btn btn-primary" onclick="saveRechargeConfig()">ğŸ’¾ ä¿å­˜é…ç½®</button>
                <button class="btn btn-secondary" onclick="resetRechargeForm()">ğŸ”„ é‡ç½®</button>
              </div>
            </div>

            <div class="table-container">
              <div class="table-header">
                <div class="table-header-title">å……å€¼å¸ç§é…ç½®åˆ—è¡¨</div>
                <button class="refresh-btn" onclick="loadRechargeConfigs()">ğŸ”„ åˆ·æ–°</button>
              </div>
              <table>
                <thead>
                  <tr>
                    <th>å¸ç§</th>
                    <th>ç½‘ç»œ</th>
                    <th>é’±åŒ…åœ°å€</th>
                    <th>æœ€å°é‡‘é¢</th>
                    <th>äºŒç»´ç </th>
                    <th>å¯ç”¨</th>
                    <th>æ“ä½œ</th>
                  </tr>
                </thead>
                <tbody id="rechargeConfigTable">
                  <tr><td colspan="7" class="empty-state">åŠ è½½ä¸­...</td></tr>
                </tbody>
              </table>
            </div>
          </div>

          <!-- å……å€¼è®¢å• -->
          <div id="rechargeOrdersTab" style="display: none;">
            <div class="table-container">
              <div class="table-header">
                <div class="table-header-title">å……å€¼è®¢å•å®¡æ ¸</div>
                <button class="refresh-btn" onclick="loadRechargeOrders()">ğŸ”„ åˆ·æ–°</button>
              </div>
              <table>
                <thead>
                  <tr>
                    <th>ç”¨æˆ·</th>
                    <th>å¸ç§</th>
                    <th>é‡‘é¢</th>
                    <th>ç½‘ç»œ</th>
                    <th>äº¤æ˜“å“ˆå¸Œ</th>
                    <th>çŠ¶æ€</th>
                    <th>åˆ›å»ºæ—¶é—´</th>
                    <th>æ“ä½œ</th>
                  </tr>
                </thead>
                <tbody id="rechargeTable">
                  <tr><td colspan="8" class="empty-state">åŠ è½½ä¸­...</td></tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>

        <!-- æç°ç®¡ç† -->
        <div id="withdraw" class="section">
          <h1 class="section-title">æç°ç®¡ç†</h1>
          <div class="table-container">
            <div class="table-header">
              <div class="table-header-title">æç°è®¢å•å®¡æ ¸</div>
              <button class="refresh-btn" onclick="loadWithdrawOrders()">ğŸ”„ åˆ·æ–°</button>
            </div>
            <table>
              <thead>
                <tr>
                  <th>ç”¨æˆ·</th>
                  <th>å¸ç§</th>
                  <th>é‡‘é¢</th>
                  <th>æç°åœ°å€</th>
                  <th>çŠ¶æ€</th>
                  <th>åˆ›å»ºæ—¶é—´</th>
                  <th>æ“ä½œ</th>
                </tr>
              </thead>
              <tbody id="withdrawTable">
                <tr><td colspan="7" class="empty-state">åŠ è½½ä¸­...</td></tr>
              </tbody>
            </table>
          </div>
        </div>

        <!-- æç°å®¡æ ¸æ¨¡æ€æ¡† -->
        <div id="withdrawReviewModal" class="modal" style="display: none;">
          <div class="modal-content" style="width: 90%; max-width: 600px;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
              <h2 style="margin: 0; color: #ffd700;">æç°è®¢å•å®¡æ ¸</h2>
              <button onclick="closeWithdrawReviewModal()" style="background: none; border: none; color: #ffd700; font-size: 24px; cursor: pointer;">Ã—</button>
            </div>
            
            <div style="background: #2d2d44; padding: 15px; border-radius: 8px; margin-bottom: 20px; border-left: 4px solid #ffd700;">
              <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px;">
                <div>
                  <label style="color: #888; font-size: 0.9em;">ç”¨æˆ·å</label>
                  <div style="color: #fff; font-weight: 600;" id="reviewUsername">-</div>
                </div>
                <div>
                  <label style="color: #888; font-size: 0.9em;">è®¢å•ID</label>
                  <div style="color: #fff; font-weight: 600; word-break: break-all;" id="reviewOrderId">-</div>
                </div>
                <div>
                  <label style="color: #888; font-size: 0.9em;">å¸ç§/é‡‘é¢</label>
                  <div style="color: #fff; font-weight: 600;" id="reviewCoinAmount">-</div>
                </div>
                <div>
                  <label style="color: #888; font-size: 0.9em;">æç°åœ°å€</label>
                  <div style="color: #fff; font-weight: 600; word-break: break-all; font-size: 0.9em;" id="reviewAddress">-</div>
                </div>
              </div>
            </div>

            <div style="margin-bottom: 20px;">
              <label style="color: #aaa; display: block; margin-bottom: 8px;">ğŸ’¬ å®¡æ ¸å¤‡æ³¨ï¼ˆå¿…å¡«ï¼‰</label>
              <textarea id="withdrawNotes" placeholder="è¯·è¾“å…¥å®¡æ ¸æ„è§æˆ–æ‹’ç»åŸå› ..." style="width: 100%; height: 100px; padding: 10px; border: 1px solid #404050; border-radius: 6px; background: #2d2d44; color: #fff; font-size: 0.95em; resize: vertical;"></textarea>
            </div>

            <div style="margin-bottom: 20px;">
              <label style="color: #aaa; display: block; margin-bottom: 8px;">ğŸ”— äº¤æ˜“å“ˆå¸Œï¼ˆå®¡æ ¸é€šè¿‡æ—¶ï¼‰</label>
              <input type="text" id="withdrawTxHash" placeholder="è¾“å…¥åŒºå—é“¾äº¤æ˜“å“ˆå¸Œ..." style="width: 100%; padding: 10px; border: 1px solid #404050; border-radius: 6px; background: #2d2d44; color: #fff; font-size: 0.95em;">
            </div>

            <div style="display: flex; gap: 10px; justify-content: flex-end;">
              <button onclick="closeWithdrawReviewModal()" class="btn-secondary" style="padding: 10px 20px;">å–æ¶ˆ</button>
              <button onclick="submitWithdrawReview('rejected')" class="btn-danger" style="padding: 10px 20px; background: #f44336; border: none; border-radius: 6px; color: #fff; cursor: pointer;">âœ— æ‹’ç»</button>
              <button onclick="submitWithdrawReview('approved')" class="btn-success" style="padding: 10px 20px; background: #4caf50; border: none; border-radius: 6px; color: #fff; cursor: pointer;">âœ“ é€šè¿‡</button>
            </div>
          </div>
        </div>

        <!-- å€Ÿè´·ç®¡ç† -->
        <div id="lending" class="section">
          <h1 class="section-title">å€Ÿè´·ç®¡ç†</h1>
          
          <!-- æ ‡ç­¾é¡µåˆ‡æ¢ -->
          <div style="margin-bottom: 20px; display: flex; gap: 10px;">
            <button class="tab-btn active" onclick="switchLendingTab('applications')">ğŸ“‹ å€Ÿè´·ç”³è¯·</button>
            <button class="tab-btn" onclick="switchLendingTab('products')">ğŸ’¼ äº§å“ç®¡ç†</button>
          </div>
          
          <!-- å€Ÿè´·ç”³è¯·æ ‡ç­¾é¡µ -->
          <div id="applicationsTab" class="lending-tab" style="display: block;">
            <div class="table-container">
              <div class="table-header">
                <div class="table-header-title">å¾…å®¡æ ¸å€Ÿè´·ç”³è¯·</div>
                <button class="refresh-btn" onclick="loadLendingApplications()">ğŸ”„ åˆ·æ–°</button>
              </div>
              <table>
                <thead>
                  <tr>
                    <th>ç”¨æˆ·</th>
                    <th>ç”³è¯·é‡‘é¢</th>
                    <th>åˆ©ç‡</th>
                    <th>æœŸé™</th>
                    <th>ç”³è¯·æ—¶é—´</th>
                    <th>æ“ä½œ</th>
                  </tr>
                </thead>
                <tbody id="lendingTable">
                  <tr><td colspan="6" class="empty-state">åŠ è½½ä¸­...</td></tr>
                </tbody>
              </table>
            </div>
          </div>
          
          <!-- äº§å“ç®¡ç†æ ‡ç­¾é¡µ -->
          <div id="productsTab" class="lending-tab" style="display: none;">
            <div style="margin-bottom: 20px;">
              <button class="btn btn-primary" onclick="showLendingProductForm()">â• æ–°å¢äº§å“</button>
            </div>
            
            <!-- æ–°å¢/ç¼–è¾‘è¡¨å• -->
            <div id="lendingProductForm" style="display: none; margin-bottom: 20px; padding: 20px; background: #f5f5f5; border-radius: 8px;">
              <h3 style="margin-bottom: 15px;">ç¼–è¾‘å€Ÿè´·äº§å“</h3>
              <div class="form-row">
                <div class="form-group">
                  <label>äº§å“åç§°</label>
                  <input type="text" id="productName" placeholder="è¾“å…¥äº§å“åç§°">
                </div>
                <div class="form-group">
                  <label>äº§å“æè¿°</label>
                  <input type="text" id="productDesc" placeholder="è¾“å…¥äº§å“æè¿°">
                </div>
              </div>
              <div class="form-row">
                <div class="form-group">
                  <label>æœ€å°é‡‘é¢</label>
                  <input type="number" id="productMinAmount" placeholder="æœ€å°é‡‘é¢" min="0">
                </div>
                <div class="form-group">
                  <label>æœ€å¤§é‡‘é¢</label>
                  <input type="number" id="productMaxAmount" placeholder="æœ€å¤§é‡‘é¢" min="0">
                </div>
              </div>
              <div class="form-row">
                <div class="form-group">
                  <label>åˆ©ç‡ (%)</label>
                  <input type="number" id="productRate" placeholder="åˆ©ç‡" step="0.1" min="0">
                </div>
                <div class="form-group">
                  <label>æœŸé™ (å¤©)</label>
                  <input type="number" id="productTerm" placeholder="æœŸé™" min="1">
                </div>
              </div>
              <div class="form-row">
                <div class="form-group">
                  <label>
                    <input type="checkbox" id="productEnabled" checked>
                    å¯ç”¨æ­¤äº§å“
                  </label>
                </div>
              </div>
              <div style="display: flex; gap: 10px;">
                <button class="btn btn-success" onclick="saveLendingProduct()">âœ“ ä¿å­˜</button>
                <button class="btn btn-secondary" onclick="cancelLendingProductForm()">âœ• å–æ¶ˆ</button>
              </div>
            </div>
            
            <!-- äº§å“åˆ—è¡¨ -->
            <div class="table-container">
              <div class="table-header">
                <div class="table-header-title">å€Ÿè´·äº§å“åˆ—è¡¨</div>
                <button class="refresh-btn" onclick="loadLendingProducts()">ğŸ”„ åˆ·æ–°</button>
              </div>
              <table>
                <thead>
                  <tr>
                    <th>äº§å“åç§°</th>
                    <th>é‡‘é¢èŒƒå›´</th>
                    <th>åˆ©ç‡</th>
                    <th>æœŸé™</th>
                    <th>çŠ¶æ€</th>
                    <th>æ“ä½œ</th>
                  </tr>
                </thead>
                <tbody id="productsTable">
                  <tr><td colspan="6" class="empty-state">åŠ è½½ä¸­...</td></tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>

        <!-- é¡µé¢ç®¡ç† -->
        <div id="pages" class="section">
          <h1 class="section-title">é¡µé¢ç®¡ç†</h1>
          <div style="margin-bottom: 20px; display: flex; gap: 10px; flex-wrap: wrap;">
            <button class="btn btn-primary" data-page="home">é¦–é¡µ</button>
            <button class="btn btn-primary" data-page="about">å…³äº</button>
            <button class="btn btn-primary" data-page="market">è¡Œæƒ…</button>
          </div>
          <p style="color: var(--text-muted); font-size: 13px;">é¡µé¢ç®¡ç†åŠŸèƒ½å·²é›†æˆ</p>
        </div>

        <!-- ç³»ç»Ÿè®¾ç½® -->
        <div id="system" class="section">
          <h1 class="section-title">ç³»ç»Ÿè®¾ç½®</h1>
          <div class="stat-card" style="max-width: 400px;">
            <div style="margin-bottom: 20px;">
              <label style="display: block; margin-bottom: 8px; color: var(--text-muted); font-size: 14px;">ç³»ç»ŸçŠ¶æ€</label>
              <div style="font-size: 18px; color: var(--success); font-weight: 600;">âœ“ æ­£å¸¸è¿è¡Œ</div>
            </div>
            <div style="margin-bottom: 20px;">
              <label style="display: block; margin-bottom: 8px; color: var(--text-muted); font-size: 14px;">æ•°æ®åº“</label>
              <div style="font-size: 18px; color: var(--success); font-weight: 600;">âœ“ å·²è¿æ¥</div>
            </div>
            <button class="btn btn-primary" onclick="testConnection()">æµ‹è¯•è¿æ¥</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    const API_BASE = (() => {
      const protocol = window.location.protocol;
      const host = window.location.host;
      return `${protocol}//${host}/api`;
    })();

    // æ ‡é¢˜æ˜ å°„
    const titles = {
      dashboard: 'ä»ªè¡¨ç›˜',
      users: 'ç”¨æˆ·ç®¡ç†',
      'primary-auth': 'åˆçº§è®¤è¯å®¡æ ¸',
      'advanced-auth': 'é«˜çº§è®¤è¯å®¡æ ¸',
      'quick-contract': 'ç§’åˆçº¦é…ç½®',
      'contract-trades': 'ç§’åˆçº¦äº¤æ˜“ç®¡ç†',
      wealth: 'ç†è´¢äº§å“ç®¡ç†',
      'exchange-rates': 'å¸ç§å…‘æ¢ç®¡ç†',
      balance: 'ç”¨æˆ·ä½™é¢ç®¡ç†',
      recharge: 'å……å€¼ç®¡ç†',
      withdraw: 'æç°ç®¡ç†',
      lending: 'å€Ÿè´·ç”³è¯·ç®¡ç†',
      pages: 'é¡µé¢ç®¡ç†',
      system: 'ç³»ç»Ÿè®¾ç½®'
    };

    // å¯¼èˆªå¤„ç†
    document.querySelectorAll('.nav-link').forEach(link => {
      link.addEventListener('click', (e) => {
        e.preventDefault();
        const section = link.getAttribute('data-section');
        switchSection(section);
      });
    });

    function switchSection(sectionId) {
      // éšè—æ‰€æœ‰éƒ¨åˆ†
      document.querySelectorAll('.section').forEach(el => {
        el.classList.remove('active');
      });

      // ç§»é™¤æ‰€æœ‰å¯¼èˆªé“¾æ¥çš„activeç±»
      document.querySelectorAll('.nav-link').forEach(link => {
        link.classList.remove('active');
      });

      // æ˜¾ç¤ºé€‰å®šçš„éƒ¨åˆ†
      const section = document.getElementById(sectionId);
      if (section) {
        section.classList.add('active');
      }

      // è®¾ç½®activeå¯¼èˆªé“¾æ¥
      document.querySelector(`[data-section="${sectionId}"]`).classList.add('active');

      // æ›´æ–°æ ‡é¢˜
      document.getElementById('headerTitle').textContent = titles[sectionId] || 'ä»ªè¡¨ç›˜';

      // åŠ è½½æ•°æ®
      if (sectionId === 'users') loadUsers();
      if (sectionId === 'primary-auth') loadPrimaryAuth();
      if (sectionId === 'advanced-auth') loadAdvancedAuth();
      if (sectionId === 'quick-contract') loadContractConfig();
      if (sectionId === 'contract-trades') loadContractTrades();
      if (sectionId === 'wealth') loadWealthProducts();
      if (sectionId === 'exchange-rates') loadExchangeRates();
      if (sectionId === 'balance') loadBalanceUsers();
      if (sectionId === 'recharge') loadRechargeOrders();
      if (sectionId === 'withdraw') loadWithdrawOrders();
      if (sectionId === 'lending') loadLendingApplications();
    }

    // ============== API Functions ==============
    async function loadDashboard() {
      const token = localStorage.getItem('adminToken');
      try {
        const res = await fetch(`${API_BASE}/admin/stats`, {
          headers: { 'Authorization': `Bearer ${token}` }
        });
        const data = await res.json();
        if (data.success) {
          document.getElementById('statUsers').textContent = data.data.totalUsers || 0;
          document.getElementById('statTrades').textContent = data.data.totalOrders || 0;
          document.getElementById('statPending').textContent = data.data.pendingVerifications || 0;
          document.getElementById('statAssets').textContent = '$' + (data.data.totalRevenue || 0).toFixed(2);
        }
      } catch (err) {
        console.error('Failed to load dashboard:', err);
      }
    }

    async function loadUsers() {
      const token = localStorage.getItem('adminToken');
      try {
        const res = await fetch(`${API_BASE}/admin/users`, {
          headers: { 'Authorization': `Bearer ${token}` }
        });
        const data = await res.json();
        if (data.success && Array.isArray(data.data)) {
          const table = document.getElementById('usersTable');
          table.innerHTML = data.data.map(user => `
            <tr>
              <td>${user.username}</td>
              <td>${user.email || 'N/A'}</td>
              <td>${user.phone || 'N/A'}</td>
              <td><span class="status-badge status-${user.status === 'active' ? 'success' : 'danger'}">${user.status === 'active' ? 'æ´»è·ƒ' : 'ç¦ç”¨'}</span></td>
              <td>
                <button class="btn btn-primary btn-small" onclick="toggleUserStatus('${user.id}')">åˆ‡æ¢çŠ¶æ€</button>
                <button class="btn btn-danger btn-small" onclick="deleteUser('${user.id}', '${user.username}')">åˆ é™¤</button>
              </td>
            </tr>
          `).join('');
        }
      } catch (err) {
        console.error('Failed to load users:', err);
      }
    }

    async function loadPrimaryAuth() {
      const token = localStorage.getItem('adminToken');
      try {
        const res = await fetch(`${API_BASE}/admin/auth/primary`, {
          headers: { 'Authorization': `Bearer ${token}` }
        });
        const data = await res.json();
        if (data.success && Array.isArray(data.data)) {
          const table = document.getElementById('primaryAuthTable');
          const statusBadge = (status) => {
            if (status === 'approved') return '<span class="badge badge-success">å·²æ‰¹å‡†</span>';
            if (status === 'rejected') return '<span class="badge badge-danger">å·²é©³å›</span>';
            return '<span class="badge badge-warning">å¾…å®¡æ ¸</span>';
          };
          table.innerHTML = data.data.length > 0 ? data.data.map(auth => `
            <tr>
              <td>${auth.username}</td>
              <td>${auth.idNumber || 'N/A'}</td>
              <td>${new Date(auth.submittedAt).toLocaleDateString()}</td>
              <td>${statusBadge(auth.status)}</td>
              <td>
                <button class="btn btn-success btn-small" onclick="approvePrimaryAuth('${auth.id}')">æ‰¹å‡†</button>
                <button class="btn btn-danger btn-small" onclick="rejectAuth('${auth.id}')">é©³å›</button>
              </td>
            </tr>
          `).join('') : '<tr><td colspan="5" class="empty-state">æš‚æ— å¾…å®¡æ ¸è®¤è¯</td></tr>';
        }
      } catch (err) {
        console.error('Failed to load primary auth:', err);
      }
    }

    async function loadAdvancedAuth() {
      const token = localStorage.getItem('adminToken');
      try {
        const res = await fetch(`${API_BASE}/admin/auth/advanced`, {
          headers: { 'Authorization': `Bearer ${token}` }
        });
        const data = await res.json();
        if (data.success && Array.isArray(data.data)) {
          const table = document.getElementById('advancedAuthTable');
          const statusBadge = (status) => {
            if (status === 'approved') return '<span class="badge badge-success">å·²æ‰¹å‡†</span>';
            if (status === 'rejected') return '<span class="badge badge-danger">å·²é©³å›</span>';
            return '<span class="badge badge-warning">å¾…å®¡æ ¸</span>';
          };
          table.innerHTML = data.data.length > 0 ? data.data.map(auth => `
            <tr>
              <td>${auth.username}</td>
              <td>${auth.bankCard || 'N/A'}</td>
              <td>${new Date(auth.submittedAt).toLocaleDateString()}</td>
              <td>${statusBadge(auth.status)}</td>
              <td>
                <button class="btn btn-success btn-small" onclick="approveAdvancedAuth('${auth.id}')">æ‰¹å‡†</button>
                <button class="btn btn-danger btn-small" onclick="rejectAuth('${auth.id}')">é©³å›</button>
              </td>
            </tr>
          `).join('') : '<tr><td colspan="5" class="empty-state">æš‚æ— å¾…å®¡æ ¸è®¤è¯</td></tr>';
        }
      } catch (err) {
        console.error('Failed to load advanced auth:', err);
      }
    }

    async function loadContractConfig() {
      // åŠ è½½ç§’åˆçº¦å‘¨æœŸé…ç½®
      loadQuickContractConfig();
      // ä¹ŸåŠ è½½äº¤æ˜“è®°å½•
      loadQuickContractTrades();
    }

    async function loadContractTrades() {
      const token = localStorage.getItem('adminToken');
      try {
        const res = await fetch(`${API_BASE}/admin/quick-contract/trades`, {
          headers: { 'Authorization': `Bearer ${token}` }
        });
        const data = await res.json();
        if (data.success && Array.isArray(data.data)) {
          const table = document.getElementById('tradesTable');
          table.innerHTML = data.data.length > 0 ? data.data.map(trade => `
            <tr>
              <td>${trade.username}</td>
              <td>${trade.symbol}</td>
              <td><span class="badge ${trade.direction === 'çœ‹æ¶¨' ? 'badge-success' : 'badge-danger'}">${trade.direction}</span></td>
              <td>$${trade.amount.toFixed(2)}</td>
              <td>${trade.seconds}ç§’</td>
              <td>$${trade.entryPrice.toFixed(2)}</td>
              <td>${trade.status === 'pending' ? '-' : '$' + trade.exitPrice.toFixed(2)}</td>
              <td>${trade.status === 'pending' ? '-' : (trade.profit >= 0 ? '+' : '') + trade.profit.toFixed(2)}</td>
              <td>
                ${trade.status === 'pending' ? '<span class="badge badge-warning">â³ å¾…å¼€å¥–</span>' : 
                  (trade.result === 'win' ? '<span class="badge badge-success">âœ“ èµ¢</span>' : '<span class="badge badge-danger">âœ— äº</span>')}
              </td>
              <td>
                ${trade.status === 'pending' ? 
                  `<button class="btn btn-success btn-small" onclick="setTradeResultWin('${trade.id}')">âœ“ è®¾ä¸ºèµ¢</button>
                   <button class="btn btn-danger btn-small" onclick="setTradeResultLoss('${trade.id}')">âœ— è®¾ä¸ºäº</button>` : 
                  '<span style="font-size: 12px; color: #999;">å·²å¤„ç†</span>'}
              </td>
            </tr>
          `).join('') : '<tr><td colspan="10" class="empty-state">æš‚æ— äº¤æ˜“</td></tr>';
        }
      } catch (err) {
        console.error('Failed to load trades:', err);
      }
    }
    
    async function setTradeResultWin(tradeId) {
      if (!confirm('ç¡®å®šè¦è®¾ç½®æ­¤è®¢å•ä¸ºèµ¢å—ï¼Ÿ')) return;
      await setTradeResult(tradeId, 'win');
    }
    
    async function setTradeResultLoss(tradeId) {
      if (!confirm('ç¡®å®šè¦è®¾ç½®æ­¤è®¢å•ä¸ºäºå—ï¼Ÿ')) return;
      await setTradeResult(tradeId, 'loss');
    }
    
    async function setTradeResult(tradeId, result) {
      const token = localStorage.getItem('adminToken');
      try {
        const res = await fetch(`${API_BASE}/admin/quick-contract/trades/${tradeId}`, {
          method: 'PUT',
          headers: { 
            'Authorization': `Bearer ${token}`,
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({ result })
        });
        const data = await res.json();
        if (data.success) {
          alert(`âœ“ è®¢å•å·²è®¾ä¸º${result === 'win' ? 'èµ¢' : 'äº'}ï¼Œç”¨æˆ·è·å¾— ${data.order.profit} USDT`);
          loadContractTrades();
        } else {
          alert('æ“ä½œå¤±è´¥: ' + data.error);
        }
      } catch (err) {
        console.error('Failed to set trade result:', err);
        alert('è®¾ç½®å¤±è´¥');
      }
    }

    // ============== Action Functions ==============
    function saveContractConfig() {
      alert('ç§’åˆçº¦é…ç½®å·²ä¿å­˜');
    }

    function approvePrimaryAuth(id) {
      if (confirm('ç¡®å®šè¦æ‰¹å‡†è¯¥è®¤è¯å—ï¼Ÿ')) {
        const token = localStorage.getItem('adminToken');
        fetch(`${API_BASE}/admin/auth/approve`, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'Authorization': `Bearer ${token}`
          },
          body: JSON.stringify({ certificationId: id })
        })
        .then(res => res.json())
        .then(data => {
          if (data.success) {
            alert('âœ… åˆçº§è®¤è¯å·²æ‰¹å‡†');
            loadPrimaryAuth();
          } else {
            alert('âŒ æ‰¹å‡†å¤±è´¥: ' + data.message);
          }
        })
        .catch(err => {
          console.error('Error:', err);
          alert('âŒ è¯·æ±‚å¤±è´¥');
        });
      }
    }

    function approveAdvancedAuth(id) {
      if (confirm('ç¡®å®šè¦æ‰¹å‡†è¯¥è®¤è¯å—ï¼Ÿ')) {
        const token = localStorage.getItem('adminToken');
        fetch(`${API_BASE}/admin/auth/approve`, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'Authorization': `Bearer ${token}`
          },
          body: JSON.stringify({ certificationId: id })
        })
        .then(res => res.json())
        .then(data => {
          if (data.success) {
            alert('âœ… é«˜çº§è®¤è¯å·²æ‰¹å‡†');
            loadAdvancedAuth();
          } else {
            alert('âŒ æ‰¹å‡†å¤±è´¥: ' + data.message);
          }
        })
        .catch(err => {
          console.error('Error:', err);
          alert('âŒ è¯·æ±‚å¤±è´¥');
        });
      }
    }

    function rejectAuth(id) {
      const reason = prompt('è¯·è¾“å…¥é©³å›ç†ç”±ï¼ˆå¯é€‰ï¼‰:');
      if (reason !== null) {
        const token = localStorage.getItem('adminToken');
        fetch(`${API_BASE}/admin/auth/reject`, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'Authorization': `Bearer ${token}`
          },
          body: JSON.stringify({ certificationId: id, reason: reason })
        })
        .then(res => res.json())
        .then(data => {
          if (data.success) {
            alert('âœ… è®¤è¯å·²é©³å›');
            loadPrimaryAuth();
            loadAdvancedAuth();
          } else {
            alert('âŒ é©³å›å¤±è´¥: ' + data.message);
          }
        })
        .catch(err => {
          console.error('Error:', err);
          alert('âŒ è¯·æ±‚å¤±è´¥');
        });
      }
    }

    function setTradeResult() {
      const result = document.getElementById('tradeResult').value;
      if (result) {
        alert(`å·²è®¾ç½®äº¤æ˜“ç»“æœä¸º: ${result === 'win' ? 'èµ¢' : 'è¾“'}`);
      }
    }

    function addWealthProduct() {
      const name = document.getElementById('wealthName').value;
      if (name) {
        alert(`å·²æ·»åŠ ç†è´¢äº§å“: ${name}`);
        loadWealthProducts();
      }
    }

    async function loadWealthProducts() {
      const token = localStorage.getItem('adminToken');
      try {
        const res = await fetch(`${API_BASE}/wealth/products`, {
          headers: { 'Authorization': `Bearer ${token}` }
        });
        const data = await res.json();
        if (data.success && Array.isArray(data.data)) {
          const table = document.getElementById('wealthTable');
          table.innerHTML = data.data.length > 0 ? data.data.map(product => `
            <tr>
              <td>${product.name}</td>
              <td>${product.period}å¤©</td>
              <td>${product.rate}%</td>
              <td>$${product.minAmount}</td>
              <td>${product.purchaseCount || 0}</td>
              <td><button class="btn btn-danger btn-small" onclick="deleteProduct('${product.id}')">åˆ é™¤</button></td>
            </tr>
          `).join('') : '<tr><td colspan="6" class="empty-state">æš‚æ— äº§å“</td></tr>';
        }
      } catch (err) {
        console.error('Failed to load wealth products:', err);
      }
    }

    function switchExchangeTab(tab) {
      const allTab = document.getElementById('exchangeAllTab');
      const userTab = document.getElementById('exchangeUserTab');
      const tabs = document.querySelectorAll('#exchange-rates .tab-btn');
      
      tabs.forEach(t => t.classList.remove('active'));
      event.target.classList.add('active');
      
      if (tab === 'all') {
        allTab.style.display = 'block';
        userTab.style.display = 'none';
        loadAllExchangeRecords();
      } else {
        allTab.style.display = 'none';
        userTab.style.display = 'block';
        loadExchangeUsers();
      }
    }

    async function loadAllExchangeRecords() {
      const token = localStorage.getItem('adminToken');
      try {
        const res = await fetch(`${API_BASE}/admin/exchange/records`, {
          headers: { 'Authorization': `Bearer ${token}` }
        });
        const data = await res.json();
        if (data.success && Array.isArray(data.data)) {
          const table = document.getElementById('exchangeAllTable');
          if (data.data.length === 0) {
            table.innerHTML = '<tr><td colspan="9" class="empty-state">æš‚æ— å…‘æ¢è®°å½•</td></tr>';
          } else {
            table.innerHTML = data.data.map(record => `
              <tr>
                <td>${record.username}</td>
                <td>${record.fromCoin}</td>
                <td>${parseFloat(record.fromAmount).toFixed(6)}</td>
                <td>${record.toCoin}</td>
                <td>${parseFloat(record.toAmount).toFixed(6)}</td>
                <td>${parseFloat(record.exchangeRate).toFixed(6)}</td>
                <td>${parseFloat(record.fee).toFixed(6)}</td>
                <td>${new Date(record.createdAt).toLocaleString('zh-CN')}</td>
                <td><span class="status-badge" style="background: #4caf50; color: #fff;">âœ“ å·²å®Œæˆ</span></td>
              </tr>
            `).join('');
          }
        }
      } catch (err) {
        console.error('Failed to load exchange records:', err);
        document.getElementById('exchangeAllTable').innerHTML = '<tr><td colspan="9" class="empty-state">åŠ è½½å¤±è´¥</td></tr>';
      }
    }

    async function loadExchangeUsers() {
      const token = localStorage.getItem('adminToken');
      try {
        const res = await fetch(`${API_BASE}/admin/users`, {
          headers: { 'Authorization': `Bearer ${token}` }
        });
        const data = await res.json();
        if (data.success && Array.isArray(data.data)) {
          const select = document.getElementById('exchangeUserSelect');
          select.innerHTML = '<option value="">è¯·é€‰æ‹©ç”¨æˆ·</option>' + data.data.map(user => 
            `<option value="${user.id}">${user.username}</option>`
          ).join('');
        }
      } catch (err) {
        console.error('Failed to load users:', err);
      }
    }

    async function loadExchangeUserRecords() {
      const userId = document.getElementById('exchangeUserSelect').value;
      if (!userId) {
        document.getElementById('exchangeUserTable').innerHTML = '<tr><td colspan="8" class="empty-state">è¯·å…ˆé€‰æ‹©ç”¨æˆ·</td></tr>';
        return;
      }

      const token = localStorage.getItem('adminToken');
      try {
        const res = await fetch(`${API_BASE}/admin/exchange/user/${userId}`, {
          headers: { 'Authorization': `Bearer ${token}` }
        });
        const data = await res.json();
        if (data.success && Array.isArray(data.data)) {
          document.getElementById('exchangeUserTitle').textContent = `${data.user} çš„å…‘æ¢è®°å½•`;
          const table = document.getElementById('exchangeUserTable');
          if (data.data.length === 0) {
            table.innerHTML = '<tr><td colspan="8" class="empty-state">è¯¥ç”¨æˆ·æš‚æ— å…‘æ¢è®°å½•</td></tr>';
          } else {
            table.innerHTML = data.data.map(record => `
              <tr>
                <td>${record.fromCoin}</td>
                <td>${parseFloat(record.fromAmount).toFixed(6)}</td>
                <td>${record.toCoin}</td>
                <td>${parseFloat(record.toAmount).toFixed(6)}</td>
                <td>${parseFloat(record.exchangeRate).toFixed(6)}</td>
                <td>${parseFloat(record.fee).toFixed(6)}</td>
                <td>${new Date(record.createdAt).toLocaleString('zh-CN')}</td>
                <td><span class="status-badge" style="background: #4caf50; color: #fff;">âœ“ å·²å®Œæˆ</span></td>
              </tr>
            `).join('');
          }
        }
      } catch (err) {
        console.error('Failed to load user exchange records:', err);
        document.getElementById('exchangeUserTable').innerHTML = '<tr><td colspan="8" class="empty-state">åŠ è½½å¤±è´¥</td></tr>';
      }
    }

    async function loadExchangeRates() {
      loadAllExchangeRecords();
    }

    async function loadBalanceUsers() {
      const token = localStorage.getItem('adminToken');
      try {
        const res = await fetch(`${API_BASE}/admin/users`, {
          headers: { 'Authorization': `Bearer ${token}` }
        });
        const data = await res.json();
        if (data.success && Array.isArray(data.data)) {
          const select = document.getElementById('balanceUser');
          select.innerHTML = '<option value="">-- é€‰æ‹©ç”¨æˆ· --</option>';
          data.data.forEach(user => {
            select.innerHTML += `<option value="${user.id}">${user.username}</option>`;
          });
        }
      } catch (err) {
        console.error('Failed to load users:', err);
      }
    }

    function updateUserBalance() {
      const user = document.getElementById('balanceUser').value;
      const amount = document.getElementById('balanceAmount').value;
      if (user && amount) {
        alert(`å·²æ›´æ–°ç”¨æˆ·ä½™é¢ï¼Œå˜åŠ¨é‡‘é¢: ${amount}`);
      }
    }

    function addRechargeConfig() {
      const coin = document.getElementById('rechargeCoin').value;
      if (coin) {
        alert(`å·²æ·»åŠ å……å€¼é…ç½®: ${coin}`);
      }
    }

    function switchRechargeTab(tab) {
      const configTab = document.getElementById('rechargeConfigTab');
      const ordersTab = document.getElementById('rechargeOrdersTab');
      const tabs = document.querySelectorAll('#recharge .tab-btn');
      
      tabs.forEach(t => t.classList.remove('active'));
      event.target.classList.add('active');
      
      if (tab === 'config') {
        configTab.style.display = 'block';
        ordersTab.style.display = 'none';
        loadRechargeConfigs();
      } else {
        configTab.style.display = 'none';
        ordersTab.style.display = 'block';
        loadRechargeOrders();
      }
    }

    async function loadRechargeConfigs() {
      const token = localStorage.getItem('adminToken');
      try {
        const res = await fetch(`${API_BASE}/api/admin/recharge/config`, {
          headers: { 'Authorization': `Bearer ${token}` }
        });
        const data = await res.json();
        if (data.success && Array.isArray(data.data)) {
          const table = document.getElementById('rechargeConfigTable');
          if (data.data.length === 0) {
            table.innerHTML = '<tr><td colspan="7" class="empty-state">æš‚æ— é…ç½®</td></tr>';
          } else {
            table.innerHTML = data.data.map(config => `
              <tr>
                <td>${config.coin}</td>
                <td>${config.network}</td>
                <td style="max-width: 200px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">${config.address}</td>
                <td>${parseFloat(config.minAmount).toFixed(6)}</td>
                <td>${config.qrCodeUrl ? 'âœ“ æœ‰' : 'âœ— æ— '}</td>
                <td><span class="badge ${config.enabled ? 'badge-success' : 'badge-danger'}"> ${config.enabled ? 'âœ“ å¯ç”¨' : 'âœ— ç¦ç”¨'}</span></td>
                <td>
                  <button class="btn btn-primary btn-small" onclick="editRechargeConfig('${config.coin}')">ç¼–è¾‘</button>
                  <button class="btn btn-danger btn-small" onclick="deleteRechargeConfig('${config.coin}')">åˆ é™¤</button>
                </td>
              </tr>
            `).join('');
          }
        }
      } catch (err) {
        console.error('Failed to load recharge configs:', err);
        document.getElementById('rechargeConfigTable').innerHTML = '<tr><td colspan="7" class="empty-state">åŠ è½½å¤±è´¥</td></tr>';
      }
    }

    async function saveRechargeConfig() {
      const coin = document.getElementById('rechargeCoin').value.trim();
      const network = document.getElementById('rechargeNetwork').value.trim();
      const address = document.getElementById('rechargeAddress').value.trim();
      const minAmount = parseFloat(document.getElementById('rechargeMinAmount').value);
      const qrCodeUrl = document.getElementById('rechargeQRCode').value.trim();
      const enabled = document.getElementById('rechargeEnabled').checked;

      if (!coin || !network || !address || isNaN(minAmount)) {
        alert('è¯·å¡«å†™æ‰€æœ‰å¿…å¡«é¡¹');
        return;
      }

      const token = localStorage.getItem('adminToken');
      try {
        const res = await fetch(`${API_BASE}/api/admin/recharge/config`, {
          method: 'POST',
          headers: {
            'Authorization': `Bearer ${token}`,
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({
            coin,
            network,
            address,
            minAmount,
            qrCodeUrl,
            enabled
          })
        });

        const data = await res.json();
        if (data.success) {
          alert('âœ“ é…ç½®ä¿å­˜æˆåŠŸ');
          resetRechargeForm();
          loadRechargeConfigs();
        } else {
          alert('âœ— ä¿å­˜å¤±è´¥ï¼š' + (data.error || data.message));
        }
      } catch (err) {
        console.error('Error:', err);
        alert('ä¿å­˜å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•');
      }
    }

    async function editRechargeConfig(coin) {
      const token = localStorage.getItem('adminToken');
      try {
        const res = await fetch(`${API_BASE}/api/admin/recharge/config`, {
          headers: { 'Authorization': `Bearer ${token}` }
        });
        const data = await res.json();
        
        if (data.success) {
          const config = data.data.find(c => c.coin === coin);
          if (config) {
            document.getElementById('rechargeCoin').value = config.coin;
            document.getElementById('rechargeNetwork').value = config.network;
            document.getElementById('rechargeAddress').value = config.address;
            document.getElementById('rechargeMinAmount').value = config.minAmount;
            document.getElementById('rechargeQRCode').value = config.qrCodeUrl || '';
            document.getElementById('rechargeEnabled').checked = config.enabled;
            
            // æ»šåŠ¨åˆ°è¡¨å•
            document.querySelector('#recharge .card').scrollIntoView({ behavior: 'smooth' });
          }
        }
      } catch (err) {
        console.error('Error loading config:', err);
      }
    }

    function resetRechargeForm() {
      document.getElementById('rechargeCoin').value = '';
      document.getElementById('rechargeNetwork').value = '';
      document.getElementById('rechargeAddress').value = '';
      document.getElementById('rechargeMinAmount').value = '';
      document.getElementById('rechargeQRCode').value = '';
      document.getElementById('rechargeEnabled').checked = true;
    }

    async function deleteRechargeConfig(coin) {
      if (!confirm(`ç¡®å®šè¦åˆ é™¤ ${coin} çš„é…ç½®å—ï¼Ÿ`)) return;

      const token = localStorage.getItem('adminToken');
      try {
        const res = await fetch(`${API_BASE}/api/admin/recharge/config/${coin}`, {
          method: 'DELETE',
          headers: { 'Authorization': `Bearer ${token}` }
        });

        const data = await res.json();
        if (data.success) {
          alert('âœ“ é…ç½®å·²åˆ é™¤');
          loadRechargeConfigs();
        } else {
          alert('âœ— åˆ é™¤å¤±è´¥ï¼š' + (data.error || data.message));
        }
      } catch (err) {
        console.error('Error:', err);
        alert('åˆ é™¤å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•');
      }
    }

    async function loadRechargeOrders() {
      const token = localStorage.getItem('adminToken');
      try {
        const res = await fetch(`${API_BASE}/api/admin/recharge/orders`, {
          headers: { 'Authorization': `Bearer ${token}` }
        });
        const data = await res.json();
        if (data.success && Array.isArray(data.data)) {
          const table = document.getElementById('rechargeTable');
          if (data.data.length === 0) {
            table.innerHTML = '<tr><td colspan="8" class="empty-state">æš‚æ— è®¢å•</td></tr>';
          } else {
            table.innerHTML = data.data.map(order => {
              let statusBadge = '';
              if (order.status === 'pending') {
                statusBadge = '<span class="badge badge-warning" style="background: #ff9800; padding: 4px 8px; border-radius: 4px; font-size: 0.85em;">â³ å¾…å®¡æ ¸</span>';
              } else if (order.status === 'completed') {
                statusBadge = '<span class="badge badge-success" style="background: #4caf50; padding: 4px 8px; border-radius: 4px; font-size: 0.85em;">âœ“ å·²å®Œæˆ</span>';
              } else if (order.status === 'rejected') {
                statusBadge = '<span class="badge badge-danger" style="background: #f44336; padding: 4px 8px; border-radius: 4px; font-size: 0.85em;">âœ— å·²æ‹’ç»</span>';
              }
              
              return `
                <tr>
                  <td>${order.username}</td>
                  <td>${order.coin}</td>
                  <td>${parseFloat(order.amount).toFixed(6)}</td>
                  <td>${order.network}</td>
                  <td style="max-width: 150px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">${order.txHash || '-'}</td>
                  <td>${statusBadge}</td>
                  <td>${new Date(order.createdAt).toLocaleString('zh-CN')}</td>
                  <td>${order.status === 'pending' ? `
                    <button class="btn btn-success btn-small" onclick="approveRechargeOrder('${order.id}')">âœ“ é€šè¿‡</button>
                    <button class="btn btn-danger btn-small" onclick="rejectRechargeOrder('${order.id}')">âœ— æ‹’ç»</button>
                  ` : 'å·²å¤„ç†'}</td>
                </tr>
              `;
            }).join('');
          }
        }
      } catch (err) {
        console.error('Failed to load recharge orders:', err);
        document.getElementById('rechargeTable').innerHTML = '<tr><td colspan="8" class="empty-state">åŠ è½½å¤±è´¥</td></tr>';
      }
    }

    async function approveRechargeOrder(orderId) {
      alert('å……å€¼è®¢å•é€šè¿‡å®¡æ ¸åŠŸèƒ½å³å°†å®ç°');
    }

    async function rejectRechargeOrder(orderId) {
      alert('å……å€¼è®¢å•æ‹’ç»å®¡æ ¸åŠŸèƒ½å³å°†å®ç°');
    }

    async function loadWithdrawOrders() {
      const token = localStorage.getItem('adminToken');
      try {
        const res = await fetch(`${API_BASE}/admin/withdraw/records`, {
          headers: { 'Authorization': `Bearer ${token}` }
        });
        const data = await res.json();
        if (data.success && Array.isArray(data.data)) {
          const table = document.getElementById('withdrawTable');
          if (data.data.length === 0) {
            table.innerHTML = '<tr><td colspan="7" class="empty-state">æš‚æ— æç°è®¢å•</td></tr>';
          } else {
            table.innerHTML = data.data.map(order => {
              let statusBadge = '';
              if (order.status === 'pending') {
                statusBadge = '<span class="badge badge-warning" style="background: #ff9800; padding: 4px 8px; border-radius: 4px; font-size: 0.85em;">â³ å¾…å®¡æ ¸</span>';
              } else if (order.status === 'completed') {
                statusBadge = '<span class="badge badge-success" style="background: #4caf50; padding: 4px 8px; border-radius: 4px; font-size: 0.85em;">âœ“ å·²é€šè¿‡</span>';
              } else if (order.status === 'rejected') {
                statusBadge = '<span class="badge badge-danger" style="background: #f44336; padding: 4px 8px; border-radius: 4px; font-size: 0.85em;">âœ— å·²æ‹’ç»</span>';
              }
              
              return `
                <tr>
                  <td>${order.username}</td>
                  <td>${order.coin}</td>
                  <td>${parseFloat(order.amount).toFixed(6)}</td>
                  <td style="max-width: 200px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">${order.address}</td>
                  <td>${statusBadge}</td>
                  <td>${new Date(order.createdAt).toLocaleString('zh-CN')}</td>
                  <td>
                    ${order.status === 'pending' ? `<button class="btn btn-primary btn-small" onclick="openWithdrawReviewModal('${order.id}', '${order.username}', '${order.coin}', '${order.amount}', '${order.address}')">å®¡æ ¸</button>` : '<span style="color: #888;">-</span>'}
                  </td>
                </tr>
              `;
            }).join('');
          }
        }
      } catch (err) {
        console.error('Failed to load withdraw orders:', err);
        document.getElementById('withdrawTable').innerHTML = '<tr><td colspan="7" class="empty-state">åŠ è½½å¤±è´¥</td></tr>';
      }
    }

    function openWithdrawReviewModal(orderId, username, coin, amount, address) {
      document.getElementById('reviewUsername').textContent = username;
      document.getElementById('reviewOrderId').textContent = orderId;
      document.getElementById('reviewCoinAmount').textContent = `${coin} ${parseFloat(amount).toFixed(6)}`;
      document.getElementById('reviewAddress').textContent = address;
      document.getElementById('withdrawNotes').value = '';
      document.getElementById('withdrawTxHash').value = '';
      
      window.currentWithdrawOrderId = orderId;
      document.getElementById('withdrawReviewModal').style.display = 'flex';
    }

    function closeWithdrawReviewModal() {
      document.getElementById('withdrawReviewModal').style.display = 'none';
      window.currentWithdrawOrderId = null;
    }

    async function submitWithdrawReview(status) {
      const orderId = window.currentWithdrawOrderId;
      const notes = document.getElementById('withdrawNotes').value.trim();
      const txHash = document.getElementById('withdrawTxHash').value.trim();

      if (!notes) {
        alert('è¯·è¾“å…¥å®¡æ ¸å¤‡æ³¨');
        return;
      }

      if (status === 'approved' && !txHash) {
        alert('é€šè¿‡å®¡æ ¸æ—¶è¯·è¾“å…¥äº¤æ˜“å“ˆå¸Œ');
        return;
      }

      const token = localStorage.getItem('adminToken');
      try {
        const res = await fetch(`${API_BASE}/admin/withdraw/review/${orderId}`, {
          method: 'POST',
          headers: {
            'Authorization': `Bearer ${token}`,
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({
            status,
            notes,
            txHash: status === 'approved' ? txHash : null
          })
        });

        const data = await res.json();
        if (data.success) {
          alert(data.message);
          closeWithdrawReviewModal();
          loadWithdrawOrders();
        } else {
          alert('å®¡æ ¸å¤±è´¥ï¼š' + (data.error || data.message));
        }
      } catch (err) {
        console.error('Error submitting review:', err);
        alert('å®¡æ ¸å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•');
      }
    }

    async function loadLendingApplications() {
      const token = localStorage.getItem('adminToken');
      try {
        const res = await fetch(`${API_BASE}/admin/lending/requests`, {
          headers: { 'Authorization': `Bearer ${token}` }
        });
        const data = await res.json();
        if (data.success && Array.isArray(data.data)) {
          const table = document.getElementById('lendingTable') || document.getElementById('applicationsList');
          const html = data.data.length > 0 ? data.data.map(app => `
            <tr>
              <td>${app.username}</td>
              <td>$${app.amount}</td>
              <td>${app.term || '30'}å¤©</td>
              <td>${new Date(app.appliedAt).toLocaleDateString()}</td>
              <td>
                <button class="btn btn-success btn-small" onclick="approveLending('${app.id}')">æ‰¹å‡†</button>
                <button class="btn btn-danger btn-small" onclick="rejectLending('${app.id}')">é©³å›</button>
              </td>
            </tr>
          `).join('') : '<tr><td colspan="5" class="empty-state">æš‚æ— ç”³è¯·</td></tr>';
          if (table) table.innerHTML = html;
        }
      } catch (err) {
        console.error('Failed to load lending applications:', err);
      }
    }

    async function loadExchangeRecords() {
      const token = localStorage.getItem('adminToken');
      try {
        const res = await fetch(`${API_BASE}/admin/exchange/records`, {
          headers: { 'Authorization': `Bearer ${token}` }
        });
        const data = await res.json();
        if (data.success && Array.isArray(data.data)) {
          const table = document.getElementById('exchangeTable') || document.getElementById('exchangeList');
          const html = data.data.length > 0 ? data.data.map(ex => `
            <tr>
              <td>${ex.username}</td>
              <td>${ex.fromSymbol}</td>
              <td>${ex.toSymbol}</td>
              <td>${parseFloat(ex.fromAmount).toFixed(6)}</td>
              <td>${parseFloat(ex.toAmount).toFixed(6)}</td>
              <td>${new Date(ex.createdAt).toLocaleString('zh-CN')}</td>
            </tr>
          `).join('') : '<tr><td colspan="6" class="empty-state">æš‚æ— è®°å½•</td></tr>';
          if (table) table.innerHTML = html;
        }
      } catch (err) {
        console.error('Failed to load exchange records:', err);
      }
    }

    async function loadLendingRequests() {
      await loadLendingApplications();
    }

    async function loadWithdrawalOrders() {
      const token = localStorage.getItem('adminToken');
      try {
        const res = await fetch(`${API_BASE}/admin/withdrawal/orders`, {
          headers: { 'Authorization': `Bearer ${token}` }
        });
        const data = await res.json();
        if (data.success && Array.isArray(data.data)) {
          const table = document.getElementById('withdrawalTable') || document.getElementById('withdrawalList');
          const html = data.data.length > 0 ? data.data.map(order => {
            let statusBadge = '';
            if (order.status === 'pending') {
              statusBadge = '<span class="badge badge-warning">å¾…å¤„ç†</span>';
            } else if (order.status === 'completed') {
              statusBadge = '<span class="badge badge-success">å·²å®Œæˆ</span>';
            }
            return `
              <tr>
                <td>${order.username}</td>
                <td>${order.symbol}</td>
                <td>${parseFloat(order.amount).toFixed(6)}</td>
                <td>${order.address}</td>
                <td>${statusBadge}</td>
                <td>${new Date(order.appliedAt).toLocaleString('zh-CN')}</td>
                <td>${order.status === 'pending' ? `<button class="btn btn-primary btn-small" onclick="approveWithdrawal('${order.id}')">æ‰¹å‡†</button>` : 'å·²å¤„ç†'}</td>
              </tr>
            `;
          }).join('') : '<tr><td colspan="7" class="empty-state">æš‚æ— è®¢å•</td></tr>';
          if (table) table.innerHTML = html;
        }
      } catch (err) {
        console.error('Failed to load withdrawal orders:', err);
      }
    }

    // ============== Quick Contract Config Functions ==============
    async function loadQuickContractConfig() {
      const token = localStorage.getItem('adminToken');
      try {
        const res = await fetch(`${API_BASE}/admin/quick-contract/config`, {
          headers: { 'Authorization': `Bearer ${token}` }
        });
        const data = await res.json();
        if (data.success && Array.isArray(data.data)) {
          const table = document.getElementById('contractConfigTable');
          const html = data.data.length > 0 ? data.data.map((config, idx) => `
            <tr>
              <td>${config.seconds}</td>
              <td>${config.profitRate}%</td>
              <td>
                <button class="btn btn-sm btn-danger" onclick="deleteQuickContractPeriod(${idx})">ğŸ—‘ï¸ åˆ é™¤</button>
              </td>
            </tr>
          `).join('') : '<tr><td colspan="3" class="empty-state">æš‚æ— é…ç½®</td></tr>';
          if (table) table.innerHTML = html;
        }
      } catch (err) {
        console.error('Failed to load config:', err);
      }
    }

    async function addNewQuickContractPeriod() {
      const seconds = parseInt(document.getElementById('newSeconds').value);
      const profitRate = parseInt(document.getElementById('newProfitRate').value);
      
      if (!seconds || !profitRate) {
        alert('è¯·å¡«å†™æ‰€æœ‰å­—æ®µ');
        return;
      }

      const token = localStorage.getItem('adminToken');
      try {
        // å…ˆè·å–ç°æœ‰é…ç½®
        const getRes = await fetch(`${API_BASE}/admin/quick-contract/config`, {
          headers: { 'Authorization': `Bearer ${token}` }
        });
        const getData = await getRes.json();
        let periods = getData.data || [];

        // æ£€æŸ¥æ˜¯å¦å·²å­˜åœ¨ç›¸åŒçš„å‘¨æœŸ
        if (periods.some(p => p.seconds === seconds)) {
          alert('è¯¥å‘¨æœŸå·²å­˜åœ¨ï¼Œè¯·ä¿®æ”¹æˆ–åˆ é™¤åé‡æ–°æ·»åŠ ');
          return;
        }

        // æ·»åŠ æ–°å‘¨æœŸ
        periods.push({ seconds, profitRate });

        // ä¿å­˜æ›´æ–°çš„é…ç½®
        const saveRes = await fetch(`${API_BASE}/admin/quick-contract/config`, {
          method: 'POST',
          headers: { 
            'Authorization': `Bearer ${token}`,
            'Content-Type': 'application/json' 
          },
          body: JSON.stringify({ periods })
        });
        const saveData = await saveRes.json();
        if (saveData.success) {
          alert('å‘¨æœŸå·²æ·»åŠ ');
          document.getElementById('newSeconds').value = '60';
          document.getElementById('newProfitRate').value = '50';
          loadQuickContractConfig();
        }
      } catch (err) {
        console.error('Failed to add period:', err);
        alert('æ·»åŠ å¤±è´¥ï¼š' + err.message);
      }
    }

    async function deleteQuickContractPeriod(idx) {
      if (!confirm('ç¡®å®šè¦åˆ é™¤è¯¥å‘¨æœŸå—ï¼Ÿ')) return;

      const token = localStorage.getItem('adminToken');
      try {
        // è·å–ç°æœ‰é…ç½®
        const getRes = await fetch(`${API_BASE}/admin/quick-contract/config`, {
          headers: { 'Authorization': `Bearer ${token}` }
        });
        const getData = await getRes.json();
        let periods = getData.data || [];

        // åˆ é™¤æŒ‡å®šç´¢å¼•çš„å‘¨æœŸ
        periods.splice(idx, 1);

        // ä¿å­˜æ›´æ–°çš„é…ç½®
        const saveRes = await fetch(`${API_BASE}/admin/quick-contract/config`, {
          method: 'POST',
          headers: { 
            'Authorization': `Bearer ${token}`,
            'Content-Type': 'application/json' 
          },
          body: JSON.stringify({ periods })
        });
        const saveData = await saveRes.json();
        if (saveData.success) {
          alert('å‘¨æœŸå·²åˆ é™¤');
          loadQuickContractConfig();
        }
      } catch (err) {
        console.error('Failed to delete period:', err);
        alert('åˆ é™¤å¤±è´¥ï¼š' + err.message);
      }
    }

    async function loadQuickContractTrades() {
      const token = localStorage.getItem('adminToken');
      try {
        const res = await fetch(`${API_BASE}/admin/quick-contract/trades`, {
          headers: { 'Authorization': `Bearer ${token}` }
        });
        const data = await res.json();
        if (data.success && Array.isArray(data.data)) {
          const table = document.getElementById('tradesTable') || document.getElementById('tradesList');
          const html = data.data.length > 0 ? data.data.map(trade => `
            <tr>
              <td>${trade.username}</td>
              <td>${trade.symbol}</td>
              <td>${trade.amount}</td>
              <td><span class="badge ${trade.result === 'win' ? 'badge-success' : 'badge-danger'}">${trade.result === 'win' ? 'èµ¢' : 'äº'}</span></td>
              <td>${new Date(trade.createdAt).toLocaleString('zh-CN')}</td>
            </tr>
          `).join('') : '<tr><td colspan="5" class="empty-state">æš‚æ— äº¤æ˜“</td></tr>';
          if (table) table.innerHTML = html;
        }
      } catch (err) {
        console.error('Failed to load trades:', err);
      }
    }

    async function approveWithdrawal(withdrawalId) {
      const token = localStorage.getItem('adminToken');
      try {
        const res = await fetch(`${API_BASE}/admin/withdrawal/approve`, {
          method: 'POST',
          headers: { 'Authorization': `Bearer ${token}`, 'Content-Type': 'application/json' },
          body: JSON.stringify({ withdrawalId, txHash: 'manual_' + Date.now() })
        });
        const data = await res.json();
        if (data.success) {
          alert('æç°å·²æ‰¹å‡†');
          loadWithdrawalOrders();
        }
      } catch (err) {
        console.error('Approval failed:', err);
      }
    }

    // ============== Approval Functions ==============
    function approveRecharge(id) {
      if (confirm('ç¡®å®šè¦æ‰¹å‡†è¯¥å……å€¼è®¢å•å—ï¼Ÿ')) {
        alert('å·²æ‰¹å‡†å……å€¼è®¢å•');
        loadRechargeOrders();
      }
    }

    function rejectRecharge(id) {
      if (confirm('ç¡®å®šè¦é©³å›è¯¥å……å€¼è®¢å•å—ï¼Ÿ')) {
        alert('å·²é©³å›å……å€¼è®¢å•');
        loadRechargeOrders();
      }
    }

    function processWithdraw(id) {
      if (confirm('ç¡®å®šè¦å¤„ç†è¯¥æç°è®¢å•å—ï¼Ÿ')) {
        alert('å·²å¤„ç†æç°è®¢å•');
        loadWithdrawOrders();
      }
    }

    function approveLending(id) {
      if (confirm('ç¡®å®šè¦æ‰¹å‡†è¯¥å€Ÿè´·ç”³è¯·å—ï¼Ÿ')) {
        alert('å·²æ‰¹å‡†å€Ÿè´·ç”³è¯·');
        loadLendingApplications();
      }
    }

    function rejectLending(id) {
      if (confirm('ç¡®å®šè¦é©³å›è¯¥å€Ÿè´·ç”³è¯·å—ï¼Ÿ')) {
        alert('å·²é©³å›å€Ÿè´·ç”³è¯·');
        loadLendingApplications();
      }
    }

    // ============== å€Ÿè´·äº§å“ç®¡ç†å‡½æ•° ==============
    
    function switchLendingTab(tab) {
      // éšè—æ‰€æœ‰æ ‡ç­¾é¡µ
      document.getElementById('applicationsTab').style.display = 'none';
      document.getElementById('productsTab').style.display = 'none';
      
      // æ˜¾ç¤ºé€‰ä¸­çš„æ ‡ç­¾é¡µ
      if (tab === 'applications') {
        document.getElementById('applicationsTab').style.display = 'block';
        document.querySelectorAll('.tab-btn').forEach((btn, idx) => {
          btn.classList.toggle('active', idx === 0);
        });
        loadLendingApplications();
      } else {
        document.getElementById('productsTab').style.display = 'block';
        document.querySelectorAll('.tab-btn').forEach((btn, idx) => {
          btn.classList.toggle('active', idx === 1);
        });
        loadLendingProducts();
      }
    }
    
    async function loadLendingProducts() {
      const token = localStorage.getItem('adminToken');
      try {
        const res = await fetch(`${API_BASE}/admin/lending/products`, {
          headers: { 'Authorization': `Bearer ${token}` }
        });
        const data = await res.json();
        if (data.success && Array.isArray(data.data)) {
          const table = document.getElementById('productsTable');
          table.innerHTML = data.data.length > 0 ? data.data.map(product => `
            <tr>
              <td>${product.name}</td>
              <td>$${product.minAmount} - $${product.maxAmount}</td>
              <td>${product.rate}%</td>
              <td>${product.term}å¤©</td>
              <td>
                <span class="badge ${product.enabled ? 'badge-success' : 'badge-danger'}">
                  ${product.enabled ? 'å·²å¯ç”¨' : 'å·²ç¦ç”¨'}
                </span>
              </td>
              <td>
                <button class="btn btn-primary btn-small" onclick="editLendingProduct('${product.id}')">ç¼–è¾‘</button>
                <button class="btn btn-danger btn-small" onclick="deleteLendingProduct('${product.id}')">åˆ é™¤</button>
              </td>
            </tr>
          `).join('') : '<tr><td colspan="6" class="empty-state">æš‚æ— äº§å“</td></tr>';
        }
      } catch (err) {
        console.error('Failed to load lending products:', err);
      }
    }
    
    function showLendingProductForm() {
      document.getElementById('lendingProductForm').style.display = 'block';
      document.getElementById('productName').value = '';
      document.getElementById('productDesc').value = '';
      document.getElementById('productMinAmount').value = '';
      document.getElementById('productMaxAmount').value = '';
      document.getElementById('productRate').value = '';
      document.getElementById('productTerm').value = '';
      document.getElementById('productEnabled').checked = true;
      document.getElementById('productName').focus();
    }
    
    function cancelLendingProductForm() {
      document.getElementById('lendingProductForm').style.display = 'none';
    }
    
    async function editLendingProduct(id) {
      const token = localStorage.getItem('adminToken');
      try {
        const res = await fetch(`${API_BASE}/admin/lending/products`, {
          headers: { 'Authorization': `Bearer ${token}` }
        });
        const data = await res.json();
        const product = data.data.find(p => p.id === id);
        
        if (product) {
          document.getElementById('productName').value = product.name;
          document.getElementById('productDesc').value = product.description || '';
          document.getElementById('productMinAmount').value = product.minAmount;
          document.getElementById('productMaxAmount').value = product.maxAmount;
          document.getElementById('productRate').value = product.rate;
          document.getElementById('productTerm').value = product.term;
          document.getElementById('productEnabled').checked = product.enabled;
          
          // æ ‡è®°ä¸ºç¼–è¾‘æ¨¡å¼
          document.getElementById('productName').dataset.editId = id;
          document.getElementById('lendingProductForm').style.display = 'block';
        }
      } catch (err) {
        console.error('Failed to load product:', err);
      }
    }
    
    async function saveLendingProduct() {
      const token = localStorage.getItem('adminToken');
      const editId = document.getElementById('productName').dataset.editId;
      
      const product = {
        name: document.getElementById('productName').value,
        description: document.getElementById('productDesc').value,
        minAmount: parseFloat(document.getElementById('productMinAmount').value),
        maxAmount: parseFloat(document.getElementById('productMaxAmount').value),
        rate: parseFloat(document.getElementById('productRate').value),
        term: parseInt(document.getElementById('productTerm').value),
        enabled: document.getElementById('productEnabled').checked ? 1 : 0
      };
      
      if (!product.name || !product.minAmount || !product.maxAmount || !product.rate || !product.term) {
        alert('è¯·å¡«å†™æ‰€æœ‰å¿…å¡«å­—æ®µ');
        return;
      }
      
      try {
        let url = `${API_BASE}/admin/lending/products`;
        let method = 'POST';
        
        if (editId) {
          url += '/' + editId;
          method = 'PUT';
          delete document.getElementById('productName').dataset.editId;
        }
        
        const res = await fetch(url, {
          method: method,
          headers: { 
            'Authorization': `Bearer ${token}`,
            'Content-Type': 'application/json'
          },
          body: JSON.stringify(product)
        });
        
        const data = await res.json();
        if (data.success) {
          alert(editId ? 'äº§å“å·²æ›´æ–°' : 'äº§å“å·²åˆ›å»º');
          document.getElementById('lendingProductForm').style.display = 'none';
          loadLendingProducts();
        } else {
          alert('æ“ä½œå¤±è´¥: ' + data.error);
        }
      } catch (err) {
        console.error('Failed to save product:', err);
        alert('ä¿å­˜å¤±è´¥');
      }
    }
    
    async function deleteLendingProduct(id) {
      if (!confirm('ç¡®å®šè¦åˆ é™¤è¯¥å€Ÿè´·äº§å“å—ï¼Ÿ')) return;
      
      const token = localStorage.getItem('adminToken');
      try {
        const res = await fetch(`${API_BASE}/admin/lending/products/${id}`, {
          method: 'DELETE',
          headers: { 'Authorization': `Bearer ${token}` }
        });
        
        const data = await res.json();
        if (data.success) {
          alert('äº§å“å·²åˆ é™¤');
          loadLendingProducts();
        } else {
          alert('åˆ é™¤å¤±è´¥: ' + data.error);
        }
      } catch (err) {
        console.error('Failed to delete product:', err);
        alert('åˆ é™¤å¤±è´¥');
      }
    }

    function editUser(id) {
      alert('ç¼–è¾‘ç”¨æˆ·: ' + id);
    }

    function toggleUserStatus(userId) {
      if (confirm('ç¡®å®šè¦åˆ‡æ¢è¯¥ç”¨æˆ·çš„çŠ¶æ€å—ï¼Ÿ')) {
        const token = localStorage.getItem('adminToken');
        fetch(`${API_BASE}/admin/users/${userId}/toggle-status`, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'Authorization': `Bearer ${token}`
          }
        })
        .then(res => res.json())
        .then(data => {
          if (data.success) {
            alert('âœ… ç”¨æˆ·çŠ¶æ€å·²æ›´æ–°');
            loadUsers();
          } else {
            alert('âŒ æ›´æ–°å¤±è´¥: ' + data.message);
          }
        })
        .catch(err => {
          console.error('Error:', err);
          alert('âŒ è¯·æ±‚å¤±è´¥');
        });
      }
    }

    function deleteUser(userId, username) {
      if (confirm(`ç¡®å®šè¦åˆ é™¤ç”¨æˆ· ${username} å—ï¼Ÿæ­¤æ“ä½œæ— æ³•æ’¤é”€ï¼`)) {
        const token = localStorage.getItem('adminToken');
        fetch(`${API_BASE}/admin/users/${userId}`, {
          method: 'DELETE',
          headers: {
            'Content-Type': 'application/json',
            'Authorization': `Bearer ${token}`
          }
        })
        .then(res => res.json())
        .then(data => {
          if (data.success) {
            alert('âœ… ç”¨æˆ·å·²åˆ é™¤');
            loadUsers();
          } else {
            alert('âŒ åˆ é™¤å¤±è´¥: ' + data.message);
          }
        })
        .catch(err => {
          console.error('Error:', err);
          alert('âŒ è¯·æ±‚å¤±è´¥');
        });
      }
    }

    function loadTradeDetails() {
      alert('åŠ è½½äº¤æ˜“è¯¦æƒ…');
    }

    function editTrade(id) {
      alert('ç¼–è¾‘äº¤æ˜“: ' + id);
    }

    function deleteProduct(id) {
      if (confirm('ç¡®å®šè¦åˆ é™¤è¯¥äº§å“å—ï¼Ÿ')) {
        alert('å·²åˆ é™¤äº§å“');
        loadWealthProducts();
      }
    }

    function testConnection() {
      alert('ç³»ç»Ÿè¿è¡Œæ­£å¸¸');
    }

    function logout() {
      localStorage.removeItem('adminToken');
      localStorage.removeItem('adminUsername');
      window.location.href = 'admin-login.html';
    }

    // ============== Page Load ==============
    window.addEventListener('DOMContentLoaded', () => {
      const token = localStorage.getItem('adminToken');
      const username = localStorage.getItem('adminUsername');
      
      // å¦‚æœæ²¡æœ‰tokenï¼Œä½¿ç”¨æ¼”ç¤ºtoken
      if (!token) {
        localStorage.setItem('adminToken', 'demo-token-' + Date.now());
        localStorage.setItem('adminUsername', 'Admin');
      }

      if (username) {
        document.getElementById('adminName').textContent = username;
      } else {
        document.getElementById('adminName').textContent = 'Admin';
      }

      // åˆå§‹åŒ–æ—¶æ˜¾ç¤º dashboard section
      switchSection('dashboard');
      loadQuickContractConfig(); // åˆå§‹åŒ–æ—¶ä¹ŸåŠ è½½ç§’åˆçº¦é…ç½®

      // ============ è‡ªåŠ¨å®æ—¶åˆ·æ–° ============
      setInterval(() => {
        const activeSection = document.querySelector('[data-section-id]');
        if (activeSection) {
          const sectionId = activeSection.getAttribute('data-section-id');
          
          // æ ¹æ®å½“å‰æ´»è·ƒçš„sectionè‡ªåŠ¨åˆ·æ–°
          if (sectionId === 'dashboard') loadDashboard();
          else if (sectionId === 'users') loadUsers();
          else if (sectionId === 'primary-auth') loadPrimaryAuth();
          else if (sectionId === 'advanced-auth') loadAdvancedAuth();
          else if (sectionId === 'quick-contract') {
            loadQuickContractConfig();
            loadQuickContractTrades();
          }
          else if (sectionId === 'contract-trades') loadQuickContractTrades();
          else if (sectionId === 'wealth') loadLendingProducts();
          else if (sectionId === 'exchange-rates') loadExchangeRecords();
          else if (sectionId === 'recharge') loadRechargeOrders();
          else if (sectionId === 'lending') loadLendingRequests();
          else if (sectionId === 'withdrawal') loadWithdrawalOrders();
        }
      }, 3000); // æ¯3ç§’åˆ·æ–°ä¸€æ¬¡
    });
  </script>
</body>
</html>
